@model SkemaSystem.Models.Scheme

@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Edit</h2>

<div class="row">
    <div class="col-sm-8">
        <form class="form-horizontal" action="@Url.Action("Edit")" method="post">

            <div class="form-group">
                <div class="col-sm-2">
                    <label class="control-label" for="name">Navn:</label>
                </div>
                <div class="col-sm-6">
                    <input class="form-control" value="@Model.Name" type="text" name="name" id="name" placeholder="Valgfags navn" />
                </div>
            </div>
            <table class="table">
                <tr>
                    <td colspan="2"><b>Klasser</b></td>
                </tr>
                @if (@Model != null)
                {
                    foreach (SkemaSystem.Models.Scheme s in @ViewBag.Schemes)
                    {
                        if (s.ClassModel != null)
                        {
                            <tr>
                                <td width="30%"><label for="@(s.Id)ConflictScheme">@s.ClassModel.ClassName</label></td>
                                <td><input type="checkbox" name="conflictScheme" id="@(s.Id)ConflictScheme" @(@Model.ConflictSchemes.Contains(s) ? "checked" : "") value="@s.Id" /></td>
                            </tr>
                        }
                    }
                }

                <tr>
                    <td colspan="2"><b>Valgfag</b></td>
                </tr>

                @if (@Model != null)
                {
                    foreach (SkemaSystem.Models.Scheme s in @ViewBag.Schemes)
                    {
                        if (s.ClassModel == null)
                        {
                            <tr>
                                <td><label for="@(s.Id)ConflictScheme">@s.Name</label></td>
                                <td><input type="checkbox" id="@(s.Id)ConflictScheme" name="conflictScheme" value="@s.Id" @(@Model.ConflictSchemes.Contains(s) ? "checked": "") /></td>
                            </tr>
                        }
                    }
                }
            </table>
            <table>
                <thead>
                    <tr>
                        <th width="50%">Fag</th>
                        <th>Antal blokke</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var subject in ViewBag.Subjects)
                    {
                        SkemaSystem.Models.Subject su = subject;
                        
                        SkemaSystem.Models.SemesterSubjectBlock ssb = @Model.OptionalSubjectBlockList.Where(x=>x.Subject.Id == su.Id).FirstOrDefault();
                        
                        bool isChosen = @Model.OptionalSubjectBlockList.Any(x => x.Subject.Id==su.Id);

                        @Html.Hidden("subjectId", su.Id);
                        <tr style="height:53px;">
                            <td><input type="checkbox" value="@(su.Id)" name="subjectUse" id="@(su.Id)subjectCheckBox" @(isChosen ? "checked" : "") onclick="$('#@(su.Id)subjectBlockCount').toggle('fast')" />&nbsp;&nbsp; <label for="@(su.Id)subjectCheckBox">@su.Name</label></td>
                            <td><input type="number" name="subjectBlockCount" id="@(su.Id)subjectBlockCount" placeholder="Antal blokke" class="form-control" @(!isChosen ? "style=display:none;" : "value="+((ssb != null) ? ssb.BlocksCount : 0)+"")  /></td>
                        </tr>
                    }

                </tbody>
            </table>
        </form>
    </div>

    <div class="col-sm-4">
        <div class="box">
            <h2>Opret nyt fag</h2>
            <form class="form-horizontal" data-schemesys-ajax="true" data-schemesys-target="#optionalSubjects" action="@Url.Action("CreateOptionalSubject")" method="post">
                <div class="form-group">
                    <div class="col-sm-3">
                        <label class="control-label">Navn:</label>
                    </div>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" name="name" id="name" />
                    </div>
                </div>
                <input type="submit" class="btn btn-primary" value="Opret" />
            </form>
        </div>
    </div>
</div>




<div>
    @Html.ActionLink("Back to List", "Index")
</div>
